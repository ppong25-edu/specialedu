<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì„ íƒê³¼ëª© ê³ ë¥´ê¸° â€“ ë©€í‹°í˜ì´ì§€(ì´ë¯¸ì§€+SVG, ê²°ê³¼í™”ë©´)</title>
<style>
  :root { --card:#ffffff; --muted:#667085; --accent:#0f172a; --primary:#2563eb; }
  * { box-sizing:border-box; }
  body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Arial,"Apple SD Gothic Neo",sans-serif; background:linear-gradient(#fff,#f6f7fb); color:var(--accent); }
  .container { max-width:1024px; margin:0 auto; padding:20px; }
  header { display:flex; gap:12px; justify-content:space-between; align-items:center; flex-wrap:wrap; }
  h1 { margin:0; font-size:clamp(22px,3vw,32px); font-weight:800; letter-spacing:-.2px; }
  .muted { color:var(--muted); }
  .toolbar { display:flex; gap:8px; flex-wrap:wrap; }
  .btn { padding:10px 14px; border:1px solid #d1d5db; border-radius:10px; background:#fff; cursor:pointer; }
  .btn.primary { background:var(--primary); color:#fff; border-color:var(--primary); }
  .hero { padding:36px 18px; text-align:center; }
  .hero h1 { font-size:clamp(26px,4vw,42px); margin:0; }
  .hero p { margin:10px auto 0; max-width:700px; color:var(--muted); }
  .cta { margin-top:16px; display:inline-flex; gap:10px; flex-wrap:wrap; }
  .form { background:var(--card); border:1px solid #e5e7eb; border-radius:16px; box-shadow:0 4px 16px rgba(0,0,0,.04); padding:18px; }
  .form .grid { display:grid; grid-template-columns:1fr; gap:12px; }
  @media (min-width:760px){ .form .grid { grid-template-columns:repeat(3,1fr); } }
  label { font-weight:700; font-size:14px; display:block; margin-bottom:6px; }
  input { width:100%; padding:12px; border:1px solid #d1d5db; border-radius:10px; }
  .progress-wrap { margin-top:10px; }
  progress { width:100%; height:14px; appearance:none; }
  progress::-webkit-progress-bar { background:#eef2ff; border-radius:12px; }
  progress::-webkit-progress-value { background:linear-gradient(90deg,#60a5fa,#2563eb); border-radius:12px; }
  .guide { text-align:center; font-size:20px; font-weight:800; margin:18px 0 10px; }
  .row { display:grid; grid-template-columns:1fr; gap:16px; }
  @media (min-width:760px){ .row { grid-template-columns:1fr 1fr; } }
  .card { background:var(--card); border:1px solid #e5e7eb; border-radius:16px; box-shadow:0 6px 16px rgba(0,0,0,.06); overflow:hidden; }
  .card-body { padding:14px; text-align:center; }
  .illus { position:relative; width:100%; padding-top:66%; border-radius:14px; overflow:hidden; display:flex; align-items:center; justify-content:center; cursor:pointer; }
  .illus .wrap { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; }
  .illus img { width:80%; height:80%; object-fit:contain; display:none; } /* ì„±ê³µ ë¡œë“œì‹œ í‘œì‹œ */
  .illus svg { width:70%; height:70%; filter:drop-shadow(0 6px 10px rgba(0,0,0,.12)); }
  .title { font-weight:700; font-size:16px; margin-top:10px; }
  footer { text-align:center; margin:24px 0 8px; font-size:12px; color:var(--muted); }
  .hidden { display:none !important; }
  /* ê²°ê³¼ í™”ë©´ */
  .grid-3 { display:grid; grid-template-columns:1fr; gap:12px; }
  @media (min-width:840px){ .grid-3 { grid-template-columns:repeat(3,1fr); } }
  .badge { background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:14px; box-shadow:0 4px 10px rgba(0,0,0,.04); }
  .badge h4 { margin:0 0 6px; font-size:15px; }
  .rank { font-weight:800; margin-right:6px; }
  @media print { .toolbar, .hero, #page-start, #page-info, .no-print { display:none !important; } .container{max-width:900px;} }
</style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>ì„ íƒê³¼ëª© ê³ ë¥´ê¸°</h1>
        <div class="muted">ë‚˜ì—ê²Œ ë§ëŠ” ì„ íƒê³¼ëª©ì„ ì•Œì•„ë´…ì‹œë‹¤.</div>
      </div>
      <div class="toolbar">
        <button class="btn" id="navStart">ì²˜ìŒìœ¼ë¡œ</button>
        <button class="btn" id="navInfo">ì •ë³´ì…ë ¥</button>
        <button class="btn" id="navGame">ì§„í–‰í™”ë©´</button>
        <button class="btn" id="printBtn">ê²°ê³¼ ì¸ì‡„/PDF</button>
      </div>
    </header>

    <!-- ì‹œì‘ -->
    <section id="page-start" class="hero">
      <h1>ì„ íƒê³¼ëª© ê³ ë¥´ê¸°</h1>
      <p>ë‘ ê°€ì§€ í™œë™ ì¤‘ ë” ëŒë¦¬ëŠ” ê²ƒì„ ê³ ë¥´ë©°, ë‚˜ì—ê²Œ ë§ëŠ” êµê³¼(ì„ íƒê³¼ëª©) í¥ë¯¸ë¥¼ ì•Œì•„ë´…ë‹ˆë‹¤. ì´ <b><span id="roundTotal">30</span>ë¬¸í•­</b>ì…ë‹ˆë‹¤.</p>
      <div class="cta">
        <button class="btn primary" id="startToInfo">ì •ë³´ ì…ë ¥í•˜ê³  ì‹œì‘</button>
        <button class="btn" id="startToGame">ë°”ë¡œ ì§„í–‰</button>
      </div>
    </section>

    <!-- ì •ë³´ ì…ë ¥ -->
    <section id="page-info" class="hidden">
      <h2 style="margin:12px 0 8px; font-weight:800;">í•™ìƒ ì •ë³´ ì…ë ¥</h2>
      <div class="form">
        <div class="grid">
          <div><label for="school">í•™êµëª…</label><input id="school" placeholder="ì˜ˆ) â—‹â—‹íŠ¹ìˆ˜í•™êµ" /></div>
          <div><label for="grade">í•™ë…„</label><input id="grade" placeholder="ì˜ˆ) 1í•™ë…„ / ê³ 1" /></div>
          <div><label for="name">ì„±ëª…</label><input id="name" placeholder="ì˜ˆ) í™ê¸¸ë™" /></div>
        </div>
        <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
          <button class="btn primary" id="infoToGame">ì§„í–‰ ì‹œì‘</button>
          <button class="btn" id="infoClear">ì…ë ¥ ì§€ìš°ê¸°</button>
        </div>
      </div>
    </section>

    <!-- ì§„í–‰ -->
    <section id="page-game" class="hidden">
      <div class="progress-wrap">
        <progress id="progress" value="0" max="30"></progress>
        <div class="muted" style="font-size:12px;">ì§„í–‰ë„: <span id="stepNow">0</span>/<span id="stepMax">30</span></div>
      </div>
      <div class="guide">ì•„ë˜ì˜ ë‘ ê°€ì§€ ì¤‘, ë” í¥ë¯¸ë¡œìš´ í™œë™ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
      <div class="row" id="choices"></div>
    </section>

    <!-- ê²°ê³¼ -->
    <section id="page-result" class="hidden" style="margin-top:18px;">
      <h2 style="margin:0 0 8px; font-weight:800;">ê²°ê³¼</h2>
      <div id="studentMeta" class="muted" style="font-size:13px; margin-bottom:10px;"></div>
      <div class="grid-3" id="rankGrid"></div>
      <div class="no-print" style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn primary" id="againBtn">ë‹¤ì‹œ ì§„í–‰</button>
        <button class="btn" id="reshuffleBtn">ìƒˆë¡œ ì„ì–´ì„œ ì§„í–‰</button>
        <button class="btn" id="downloadBtn">ê²°ê³¼ JSON ì €ì¥</button>
        <button class="btn" id="printBtn2">ì¸ì‡„/PDF</button>
      </div>
    </section>

    <footer>Â© 2025 ë¶€ì²œêµìœ¡ì§€ì›ì²­ íŠ¹ìˆ˜í•™êµê³ êµí•™ì ì œ ì „ë¬¸ì í•™ìŠµê³µë™ì²´</footer>
  </div>

<script>
/* ==== ë°ì´í„° ==== */
const SUBJECTS = [
  { id:"ì™¸ì‹ì„œë¹„ìŠ¤", key:"food",   colorFrom:"#ffedd5", colorTo:"#ffe4e6", activities:["ì†ë‹˜ ë§ì´ ì¸ì‚¬í•˜ê¸°","ìŒì‹ ì£¼ë¬¸ë°›ê¸°","í…Œì´ë¸” ì„¸íŒ…í•˜ê¸°","ìŒì‹ ì„œë¹™í•˜ê¸°","ì£¼ë°©ê¸°ê¸° ì‚¬ìš©í•˜ê¸°","ì‹ì¬ë£Œ ì†ì§ˆÂ·ê³„ëŸ‰Â·ì¡°ë¦¬","ìŒë£ŒÂ·ë””ì €íŠ¸ ì œì¡°"]},
  { id:"ëŒ€ì¸ì„œë¹„ìŠ¤", key:"care",   colorFrom:"#dbeafe", colorTo:"#dcfce7", activities:["ì¸ì‚¬ ì˜ˆì ˆÂ·ê°ì • í‘œí˜„","ê³ ê° ìƒë‹´í•˜ê¸°","ë³´í–‰Â·ì‹ì‚¬ ë•ê¸°","ì„¸ì°¨Â·ì„¸íƒÂ·ì²­ì†Œ ë³´ì¡°","ì†í†±ê´€ë¦¬Â·ë¯¸ìš© ë³´ì¡°"]},
  { id:"ê¸°ì´ˆì‘ì—…ê¸°ìˆ 1", key:"tools", colorFrom:"#fef3c7", colorTo:"#ecfccb", activities:["ê¸°ì¤€ì— ë”°ë¼ ë¶„ë¥˜í•˜ê¸°","ì¤„ìÂ·ê³„ëŸ‰ì»µÂ·ì €ìš¸ ì‚¬ìš©","ê³µêµ¬ ì¡°ë¦½(ë“œë¼ì´ë²„Â·ë§ì¹˜)","ë‚˜ì‚¬ ì¡°ì´ê¸°","ì „ë™ë“œë¼ì´ë²„ ê¸°ì´ˆ"]},
  { id:"ê¸°ì´ˆì‘ì—…ê¸°ìˆ 2", key:"box",   colorFrom:"#ede9fe", colorTo:"#f5d0fe", activities:["í¬ì¥Â·ìš´ë°˜Â·ë¶„ë¥˜Â·ë°°ë‹¬","ì„¸íƒÂ·ì²­ì†Œ","ìƒí™œÂ·ì‹í’ˆ ì œì¡°(ë“œë¦½ë°± ë“±)","ì‚¬ë¬´ê¸°ê¸°(ë³µì‚¬Â·ì½”íŒ…Â·ì œë³¸Â·ì„¸ë‹¨)","ì‚¬ì„œë³´ì¡°(ë°”ì½”ë“œÂ·ì •ë¦¬Â·ëŒ€ì¶œ)"]},
  { id:"ë†ìƒëª…",     key:"leaf",  colorFrom:"#d1fae5", colorTo:"#a5f3fc", activities:["í™”ë¶„Â·ëª¨ì¢… ì‹¬ê¸°","ë¬¼ì£¼ê¸°Â·ì‘ë¬¼ ì¬ë°°","ë†ì¶•ì‚° ê°€ê³µ ì²´í—˜","ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬","í•™êµ í…ƒë°­Â·ì‹¤ë‚´ì •ì› ê°€ê¾¸ê¸°"]},
  { id:"ì •ë³´ì²˜ë¦¬",   key:"laptop",colorFrom:"#bae6fd", colorTo:"#c7d2fe", activities:["íƒ€ìÂ·ë¬¸ì„œÂ·í”„ë ˆì  í…Œì´ì…˜","ê·¸ë¦¼Â·ë™ì˜ìƒ ë§Œë“¤ê¸°","ì¸í„°ë„· êµ¬ë§¤Â·ê²€ìƒ‰Â·í˜‘ì—…","AIÂ·ë¬´ì¸ë‹¨ë§Â·ë””ì§€í„¸ê¸ˆìœµ","ë“œë¡ Â·ì½”ë”©ë¡œë´‡ ì²´í—˜"]},
  { id:"ì‚¬ë¬´ì§€ì›",   key:"files", colorFrom:"#e5e7eb", colorTo:"#e7e5e4", activities:["ë³µí•©ê¸° ì‚¬ìš©Â·ë¬¸ì„œ ê´€ë¦¬","ì±…ìƒÂ·íƒ•ë¹„ì‹¤ ì •ëˆ","ìš°í¸ë¬¼ í¬ì¥Â·ì „ë‹¬","ë„ì„œ ë¶„ë¥˜Â·ì •ë¦¬","ë¯¼ì› ì‘ëŒ€ ë³´ì¡°"]},
];
const TOTAL_ROUNDS = 30;

/* ==== ê³µí†µ ==== */
const $ = s => document.querySelector(s);
function randPick(a){ return a[Math.floor(Math.random()*a.length)]; }
function makeGradient(a,b){ return `linear-gradient(135deg, ${a}, ${b})`; }
function makeRounds(n=TOTAL_ROUNDS){
  const rs=[]; for(let i=0;i<n;i++){
    let a=randPick(SUBJECTS), b=randPick(SUBJECTS);
    while(b.id===a.id) b=randPick(SUBJECTS);
    rs.push({ a:{...a, highlight:randPick(a.activities)}, b:{...b, highlight:randPick(b.activities)} });
  } return rs;
}

/* ==== í•™ìƒ ì •ë³´ ==== */
let student={school:"",grade:"",name:""};
function saveStudent(){ student.school=$('#school')?.value?.trim()||""; student.grade=$('#grade')?.value?.trim()||""; student.name=$('#name')?.value?.trim()||""; localStorage.setItem("worldcup_student_v4", JSON.stringify(student)); }
function loadStudent(){ try{ const s=JSON.parse(localStorage.getItem("worldcup_student_v4")||"{}"); student=Object.assign({school:"",grade:"",name:""},s); if($('#school')) $('#school').value=student.school; if($('#grade')) $('#grade').value=student.grade; if($('#name')) $('#name').value=student.name; }catch(e){} }
function updateStudentMeta(){ const t=[student.school,student.grade,student.name].filter(Boolean).join(" Â· "); $('#studentMeta').textContent = t ? `í•™ìƒì •ë³´: ${t}` : "í•™ìƒì •ë³´: (ë¯¸ì…ë ¥)"; }

/* ==== ì•„ì´ì½˜ (ì´ë¯¸ì§€ ì„±ê³µâ†’ì´ë¯¸ì§€, ì‹¤íŒ¨â†’SVG) ==== */
function svgFallback(key){
  switch(key){
    case "leaf": return `<svg viewBox="0 0 100 100"><path d="M50 80c18-10 28-26 28-40-10-2-22 0-28 8-6-8-18-10-28-8 0 14 10 30 28 40z" fill="#86efac" stroke="#0f172a" stroke-width="2"/><path d="M50 48v32" stroke="#0f172a" stroke-width="2"/></svg>`;
    case "care": return `<svg viewBox="0 0 100 100"><path d="M20 45c0-8 6-14 14-14 6 0 10 3 16 10 6-7 10-10 16-10 8 0 14 6 14 14 0 16-30 28-30 28S20 61 20 45z" fill="#93c5fd" stroke="#0f172a" stroke-width="2"/></svg>`;
    case "food": return `<svg viewBox="0 0 100 100"><ellipse cx="50" cy="70" rx="32" ry="10" fill="#fff" stroke="#0f172a" stroke-width="2"/><path d="M18 70h64" stroke="#0f172a" stroke-width="3"/><path d="M30 68c0-10 40-10 40 0" fill="#fb923c" stroke="#0f172a" stroke-width="2"/><circle cx="30" cy="45" r="10" fill="#fde68a" stroke="#0f172a" stroke-width="2"/><ellipse cx="66" cy="48" rx="14" ry="11" fill="#fca5a5" stroke="#0f172a" stroke-width="2"/></svg>`;
    case "tools": return `<svg viewBox="0 0 100 100"><path d="M20 70l20-20 10 10-20 20z" fill="#fde68a" stroke="#0f172a" stroke-width="2"/><path d="M52 28l20 20-8 8-20-20z" fill="#fff" stroke="#0f172a" stroke-width="2"/><circle cx="65" cy="35" r="6" fill="#fff" stroke="#0f172a" stroke-width="2"/></svg>`;
    case "box": return `<svg viewBox="0 0 100 100"><path d="M20 40l30-12 30 12-30 12-30-12z" fill="#ddd6fe" stroke="#0f172a" stroke-width="2"/><path d="M20 40v30l30 12V52L20 40z" fill="#e9d5ff" stroke="#0f172a" stroke-width="2"/><path d="M50 52l30-12v30L50 82V52z" fill="#f5d0fe" stroke="#0f172a" stroke-width="2"/></svg>`;
    case "laptop": return `<svg viewBox="0 0 100 100"><rect x="22" y="28" width="56" height="34" rx="4" fill="#c7d2fe" stroke="#0f172a" stroke-width="2"/><rect x="16" y="64" width="68" height="10" rx="2" fill="#93c5fd" stroke="#0f172a" stroke-width="2"/><path d="M22 58h56" stroke="#0f172a" stroke-width="2"/></svg>`;
    case "files": return `<svg viewBox="0 0 100 100"><rect x="26" y="18" width="40" height="54" rx="4" fill="#e5e7eb" stroke="#0f172a" stroke-width="2"/><rect x="36" y="28" width="40" height="54" rx="4" fill="#f3f4f6" stroke="#0f172a" stroke-width="2"/><path d="M40 40h24M40 48h24M40 56h20" stroke="#0f172a" stroke-width="2"/></svg>`;
    default: return `<svg viewBox="0 0 100 100"><rect width="100" height="100" fill="#fff"/></svg>`;
  }
}
function choiceCard(d){
  const el=document.createElement('div'); el.className='card';
  el.innerHTML=`
    <div class="card-body">
      <div class="illus" style="background:${makeGradient(d.colorFrom,d.colorTo)}">
        <div class="wrap">
          <img alt="${d.key}" src="images/${d.key}.png">
          <div class="svgwrap">${svgFallback(d.key)}</div>
        </div>
      </div>
      <div class="title">${d.highlight}</div>
    </div>`;
  const img=el.querySelector('img'); const svg=el.querySelector('.svgwrap');
  img.addEventListener('load', ()=>{ img.style.display='block'; svg.style.display='none'; });
  img.addEventListener('error', ()=>{ img.style.display='none'; svg.style.display='block'; });
  el.querySelector('.illus').addEventListener('click', ()=>choose(d.id));
  return el;
}

/* ==== ì§„í–‰ ë¡œì§ ==== */
let rounds=[], step=0, scores=Object.fromEntries(SUBJECTS.map(s=>[s.id,0]));
function renderStep(){
  if(!rounds.length) rounds=makeRounds();
  $('#stepNow').textContent = step;
  $('#progress').value = step;
  const cur = rounds[step], box = $('#choices'); box.innerHTML='';
  box.appendChild(choiceCard(cur.a));
  box.appendChild(choiceCard(cur.b));
}
function choose(id){
  scores[id]=(scores[id]||0)+1;
  if(step+1>=TOTAL_ROUNDS){ finish(); }
  else { step++; renderStep(); }
}

/* ==== ê²°ê³¼ ==== */
function finish(){
  showPage('page-result');
  updateStudentMeta();
  const ranking = SUBJECTS.map(s=>({subject:s, score:scores[s.id]})).sort((a,b)=>b.score-a.score);
  const grid = $('#rankGrid'); grid.innerHTML='';
  ranking.forEach((r,i)=>{
    const div=document.createElement('div'); div.className='badge';
    const medal = i===0?'ğŸ¥‡':i===1?'ğŸ¥ˆ':i===2?'ğŸ¥‰':'';
    div.innerHTML = `<h4><span class="rank">${i+1}ìœ„</span> ${medal} ${r.subject.id} <span class="muted">(${r.score}ì )</span></h4>
      <ul style="margin:0; padding-left:18px; font-size:13px;">${r.subject.activities.slice(0,4).map(a=>`<li>${a}</li>`).join('')}</ul>`;
    grid.appendChild(div);
  });
  window.scrollTo(0,0);
}

/* ==== ë„¤ë¹„/í˜ì´ì§€ ì „í™˜ ==== */
function showPage(id){ ["page-start","page-info","page-game","page-result"].forEach(x=>document.getElementById(x).classList.add("hidden")); document.getElementById(id).classList.remove("hidden"); }
$('#navStart').addEventListener('click', ()=>showPage('page-start'));
$('#navInfo').addEventListener('click', ()=>{ showPage('page-info'); loadStudent(); });
$('#navGame').addEventListener('click', ()=>{ showPage('page-game'); renderStep(); });
$('#printBtn').addEventListener('click', ()=>window.print());
$('#startToInfo').addEventListener('click', ()=>showPage('page-info'));
$('#startToGame').addEventListener('click', ()=>{ showPage('page-game'); renderStep(); });
$('#infoToGame').addEventListener('click', ()=>{ saveStudent(); showPage('page-game'); renderStep(); });
$('#infoClear').addEventListener('click', ()=>{ ['school','grade','name'].forEach(id=>{ const i=document.getElementById(id); if(i) i.value=''; }); saveStudent(); });

/* ê²°ê³¼í™”ë©´ ë²„íŠ¼ */
$('#againBtn').addEventListener('click', ()=>{ scores=Object.fromEntries(SUBJECTS.map(s=>[s.id,0])); step=0; rounds=makeRounds(); showPage('page-game'); renderStep(); });
$('#reshuffleBtn').addEventListener('click', ()=>{ scores=Object.fromEntries(SUBJECTS.map(s=>[s.id,0])); step=0; rounds=makeRounds(); showPage('page-game'); renderStep(); });
$('#printBtn2').addEventListener('click', ()=>window.print());
$('#downloadBtn').addEventListener('click', ()=>{
  const payload = { total: TOTAL_ROUNDS, scores, ranking: SUBJECTS.map(s=>({subject:s.id, score:scores[s.id]})).sort((a,b)=>b.score-a.score), student, timestamp: new Date().toISOString() };
  const blob=new Blob([JSON.stringify(payload,null,2)],{type:"application/json"}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=`í¥ë¯¸ê²°ê³¼_${new Date().toISOString().slice(0,10)}.json`; a.click(); URL.revokeObjectURL(url);
});

/* ==== ì´ˆê¸°í™” ==== */
document.getElementById('roundTotal').textContent = TOTAL_ROUNDS;
document.getElementById('stepMax').textContent   = TOTAL_ROUNDS;
loadStudent();
showPage('page-start');
</script>
</body>
</html>
