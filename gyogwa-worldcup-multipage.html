<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì„ íƒê³¼ëª© ê³ ë¥´ê¸° â€“ êµê³¼ í¥ë¯¸ ì´ìƒí˜•ì›”ë“œì»µ</title>
<style>
  :root { --bg:#f7f8fb; --card:#ffffff; --muted:#667085; --accent:#111827; --primary:#2563eb; }
  * { box-sizing: border-box; }
  body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo", sans-serif; background: linear-gradient(#fff 0%, #f6f7fb 100%); color:#111827; }
  .container { max-width: 1024px; margin:0 auto; padding: 20px; }
  header { display:flex; gap:12px; justify-content: space-between; align-items: center; flex-wrap: wrap; }
  h1 { font-size: clamp(22px, 3vw, 32px); margin: 0; font-weight: 800; letter-spacing:-0.2px; }
  h2 { font-size: clamp(18px, 2.2vw, 24px); margin: 0 0 8px; font-weight: 800; }
  .muted { color: var(--muted); font-size: 13px; }
  .row { display:grid; grid-template-columns: 1fr; gap:16px; margin-top:16px; }
  @media (min-width: 760px) { .row { grid-template-columns: 1fr 1fr; } }
  .card { background: var(--card); border:1px solid #e5e7eb; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.04); overflow:hidden; transition: transform .12s ease, box-shadow .12s ease; }
  .card:hover { transform: translateY(-2px); box-shadow: 0 10px 24px rgba(0,0,0,0.08); }
  .card-body { padding: 14px; }
  .illus { position: relative; width: 100%; padding-top: 66%; border-radius: 14px; overflow: hidden; display:flex; align-items:center; justify-content:center; cursor: pointer; }
  .illus span { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size: clamp(64px, 10vw, 96px); filter: drop-shadow(0 1px 0 rgba(0,0,0,0.1)); }
  .title { font-weight: 700; font-size: 16px; margin-top: 10px; line-height:1.35; }
  .btn { width: 100%; margin-top:10px; padding: 12px 14px; border-radius: 12px; border:1px solid #d1d5db; background:#fff; cursor:pointer; font-weight:600; }
  .btn:hover { background:#f3f4f6; }
  .btn.primary { background: var(--primary); border-color: var(--primary); color:white; }
  .btn.secondary { background: #eef2ff; border-color:#e5e7eb; color:#1f2937; }
  .toolbar { display:flex; gap:8px; flex-wrap: wrap; }
  .toolbar .btn { width:auto; }
  .progress-wrap { margin-top: 10px; }
  progress { width:100%; height: 14px; appearance: none; }
  progress::-webkit-progress-bar { background:#eef2ff; border-radius: 12px; }
  progress::-webkit-progress-value { background: linear-gradient(90deg, #60a5fa, #2563eb); border-radius: 12px; }
  .grid-3 { display:grid; grid-template-columns: 1fr; gap:12px; }
  @media (min-width: 840px) { .grid-3 { grid-template-columns: repeat(3, 1fr); } }
  .badge { background: #ffffffb3; border:1px solid #e5e7eb; border-radius: 14px; padding: 12px; }
  .badge h4 { margin:0 0 6px; font-size:14px; }
  .rank { font-weight:800; margin-right: 6px; }
  footer { text-align:center; margin: 24px 0 8px; font-size: 12px; color: var(--muted); }
  .small { font-size: 12px; }
  .center { text-align: center; }
  .hero { padding: 36px 18px; text-align: center; }
  .hero h1 { font-size: clamp(26px, 4vw, 42px); }
  .hero p { margin: 10px auto 0; max-width: 680px; font-size: 16px; color: var(--muted); }
  .hero .cta { margin-top: 16px; display: inline-flex; gap:10px; }
  .hero .cta .btn { width:auto; padding: 12px 18px; }
  .form { background: var(--card); border:1px solid #e5e7eb; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.04); padding: 18px; }
  .form .row2 { display:grid; grid-template-columns: 1fr; gap: 12px; }
  @media (min-width: 760px) { .form .row2 { grid-template-columns: 1fr 1fr 1fr; } }
  .form label { font-weight: 700; font-size: 14px; display:block; margin-bottom: 6px; }
  .form input { width: 100%; padding: 12px; border:1px solid #d1d5db; border-radius: 10px; }
  .note { font-size: 13px; color: var(--muted); margin-top: 10px; }
  .hidden { display:none !important; }

  /* ì¸ì‡„(PDF ì €ì¥) ìµœì í™” */
  @media print {
    .no-print { display: none !important; }
    .badge { break-inside: avoid; page-break-inside: avoid; }
    footer { display:none; }
    body { background: white; }
    .container { max-width: 900px; }
  }
</style>
</head>
<body>
  <div class="container">

    <!-- ê³µí†µ í—¤ë” -->
    <header class="no-print">
      <div>
        <h1>ì„ íƒê³¼ëª© ê³ ë¥´ê¸°</h1>
        <div class="muted">ë‚˜ì—ê²Œ ë§ëŠ” ì„ íƒê³¼ëª©ì„ ì•Œì•„ë´…ì‹œë‹¤.</div>
      </div>
      <div class="toolbar">
        <button class="btn" id="navStart">ì²˜ìŒìœ¼ë¡œ</button>
        <button class="btn secondary" id="navInfo">ì •ë³´ì…ë ¥</button>
        <button class="btn primary" id="navGame">ì§„í–‰í™”ë©´</button>
        <button class="btn" id="printBtn" title="PDFë¡œ ì €ì¥í•˜ë ¤ë©´ ì¸ì‡„ì—ì„œ 'PDFë¡œ ì €ì¥'ì„ ì„ íƒí•˜ì„¸ìš”.">ê²°ê³¼ ì¸ì‡„/PDF</button>
      </div>
    </header>

    <!-- 1) ì‹œì‘ í˜ì´ì§€ -->
    <section id="page-start" class="hero">
      <h1>ì„ íƒê³¼ëª© ê³ ë¥´ê¸°</h1>
      <p>ë‘ ê°€ì§€ í™œë™ ì¤‘ ë” ëŒë¦¬ëŠ” ê²ƒì„ ê³ ë¥´ë©°, ë‚˜ì—ê²Œ ë§ëŠ” êµê³¼(ì„ íƒê³¼ëª©) í¥ë¯¸ë¥¼ ì•Œì•„ë´…ë‹ˆë‹¤. ì´ <b><span id="roundTotal">30</span>ë¬¸í•­</b>ì…ë‹ˆë‹¤.</p>
      <div class="cta">
        <button class="btn primary" id="startToInfo">ì‹œì‘í•˜ê¸°</button>
        <button class="btn" id="startToGame">ë°”ë¡œ ì§„í–‰</button>
      </div>
      <div class="note">â€» ìˆ˜ì—…Â·ì—°êµ¬ìš©ìœ¼ë¡œ ììœ ë¡­ê²Œ í™œìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
    </section>

    <!-- 2) í•™ìƒ ì •ë³´ ì…ë ¥ í˜ì´ì§€ -->
    <section id="page-info" class="hidden">
      <h2>í•™ìƒ ì •ë³´ ì…ë ¥</h2>
      <div class="form">
        <div class="row2">
          <div>
            <label for="school">í•™êµëª…</label>
            <input type="text" id="school" placeholder="ì˜ˆ) â—‹â—‹íŠ¹ìˆ˜í•™êµ" />
          </div>
          <div>
            <label for="grade">í•™ë…„</label>
            <input type="text" id="grade" placeholder="ì˜ˆ) 1í•™ë…„ / ê³ 1" />
          </div>
          <div>
            <label for="name">ì„±ëª…</label>
            <input type="text" id="name" placeholder="ì˜ˆ) í™ê¸¸ë™" />
          </div>
        </div>
        <div class="note">ì…ë ¥í•œ ì •ë³´ëŠ” ê²°ê³¼ í™”ë©´ê³¼ ì¸ì‡„(PDF)ì— í•¨ê»˜ í‘œì‹œë©ë‹ˆë‹¤.</div>
        <div style="margin-top: 12px; display:flex; gap:8px; flex-wrap: wrap;">
          <button class="btn primary" id="infoToGame">ì§„í–‰ ì‹œì‘</button>
          <button class="btn" id="infoClear">ì…ë ¥ ì§€ìš°ê¸°</button>
        </div>
      </div>
    </section>

    <!-- 3) ì§„í–‰ í™”ë©´ -->
    <section id="page-game" class="hidden">
      <div class="progress-wrap">
        <progress id="progress" value="0" max="30"></progress>
        <div class="muted">ì§„í–‰ë„: <span id="stepNow">0</span>/<span id="stepMax">30</span></div>
      </div>
      <div class="row" id="choices" style="margin-top:12px;"></div>
      <div class="muted small">ì•„ë˜ì˜ ë‘ ê°€ì§€ ì¤‘, ë” í¥ë¯¸ë¡œìš´ í™œë™ì„ ì„ íƒí•˜ì„¸ìš”. ê·¸ë¦¼ì„ ëˆŒëŸ¬ë„ ì„ íƒë©ë‹ˆë‹¤.</div>
      <div class="note no-print" style="margin-top:10px;">â€» ìƒë‹¨ â€œì •ë³´ì…ë ¥â€ ë²„íŠ¼ì—ì„œ í•™êµ/í•™ë…„/ì„±ëª…ì„ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
    </section>

    <!-- 4) ê²°ê³¼ í™”ë©´ -->
    <section id="page-result" class="hidden" style="margin-top: 18px;">
      <div id="resultHeader">
        <h2>ê²°ê³¼</h2>
        <div class="muted small">ì„ íƒ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ì„ í˜¸ êµê³¼ ìˆœìœ„ì…ë‹ˆë‹¤.</div>
        <div id="studentMeta" class="muted small" style="margin-top:6px;"></div>
      </div>
      <div class="grid-3" id="rankGrid" style="margin-top:12px;"></div>
      <div class="no-print" style="margin-top:12px; display:flex; gap:8px; flex-wrap: wrap;">
        <button class="btn primary" id="againBtn">ë‹¤ì‹œ ì§„í–‰</button>
        <button class="btn" id="reshuffleBtn">ìƒˆë¡œ ì„ì–´ì„œ ì§„í–‰</button>
        <button class="btn" id="downloadBtn">ê²°ê³¼ JSON ì €ì¥</button>
        <button class="btn" id="printBtn2">ì¸ì‡„/PDF</button>
      </div>
      <div class="muted small" style="margin-top:10px;">â€» í™œë™ ì˜ˆì‹œëŠ” ì—…ë¡œë“œ ë¬¸ì„œì˜ 7ê°œ êµê³¼ í•­ëª©ì„ ë°”íƒ•ìœ¼ë¡œ ìš”ì•½í–ˆìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ëŠ” ì´ëª¨ì§€ ì¼ëŸ¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</div>
    </section>

    <footer class="no-print">Â© <span id="year"></span> ì„ íƒê³¼ëª© ê³ ë¥´ê¸° Â· êµìœ¡ìš© ìƒ˜í”Œ</footer>
  </div>

<script>
  // ===== ë°ì´í„° ì„¸íŠ¸ =====
  const SUBJECTS = [
    { id:"ì™¸ì‹ì„œë¹„ìŠ¤", emoji:"ğŸ", colorFrom:"#fed7aa", colorTo:"#fecdd3", activities:[
      "ì†ë‹˜ ë§ì´ ì¸ì‚¬í•˜ê¸°","ìŒì‹ ì£¼ë¬¸ë°›ê¸°","í…Œì´ë¸” ì„¸íŒ…í•˜ê¸°","ìŒì‹ ì„œë¹™í•˜ê¸°","ì£¼ë°©ê¸°ê¸° ì‚¬ìš©í•˜ê¸°","ì‹ì¬ë£Œ ì†ì§ˆÂ·ê³„ëŸ‰Â·ì¡°ë¦¬","ìŒë£ŒÂ·ë””ì €íŠ¸ ì œì¡°"
    ]},
    { id:"ëŒ€ì¸ì„œë¹„ìŠ¤", emoji:"ğŸ¤", colorFrom:"#bae6fd", colorTo:"#bbf7d0", activities:[
      "ì¸ì‚¬ ì˜ˆì ˆÂ·ê°ì • í‘œí˜„","ê³ ê° ìƒë‹´í•˜ê¸°","ë³´í–‰Â·ì‹ì‚¬ ë•ê¸°","ì„¸ì°¨Â·ì„¸íƒÂ·ì²­ì†Œ ë³´ì¡°","ì†í†±ê´€ë¦¬Â·ë¯¸ìš© ë³´ì¡°"
    ]},
    { id:"ê¸°ì´ˆì‘ì—…ê¸°ìˆ 1", emoji:"ğŸ”§", colorFrom:"#fde68a", colorTo:"#d9f99d", activities:[
      "ê¸°ì¤€ì— ë”°ë¼ ë¶„ë¥˜í•˜ê¸°","ì¤„ìÂ·ê³„ëŸ‰ì»µÂ·ì €ìš¸ ì‚¬ìš©","ê³µêµ¬ ì¡°ë¦½(ë“œë¼ì´ë²„Â·ë§ì¹˜)","ë‚˜ì‚¬ ì¡°ì´ê¸°","ì „ë™ë“œë¼ì´ë²„ ê¸°ì´ˆ"
    ]},
    { id:"ê¸°ì´ˆì‘ì—…ê¸°ìˆ 2", emoji:"ğŸ“¦", colorFrom:"#ddd6fe", colorTo:"#f5d0fe", activities:[
      "í¬ì¥Â·ìš´ë°˜Â·ë¶„ë¥˜Â·ë°°ë‹¬","ì„¸íƒÂ·ì²­ì†Œ","ìƒí™œÂ·ì‹í’ˆ ì œì¡°(ë“œë¦½ë°± ë“±)","ì‚¬ë¬´ê¸°ê¸°(ë³µì‚¬Â·ì½”íŒ…Â·ì œë³¸Â·ì„¸ë‹¨)","ì‚¬ì„œë³´ì¡°(ë°”ì½”ë“œÂ·ì •ë¦¬Â·ëŒ€ì¶œ)"
    ]},
    { id:"ë†ìƒëª…", emoji:"ğŸŒ¿", colorFrom:"#a7f3d0", colorTo:"#99f6e4", activities:[
      "í™”ë¶„Â·ëª¨ì¢… ì‹¬ê¸°","ë¬¼ì£¼ê¸°Â·ì‘ë¬¼ ì¬ë°°","ë†ì¶•ì‚° ê°€ê³µ ì²´í—˜","ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬","í•™êµ í…ƒë°­Â·ì‹¤ë‚´ì •ì› ê°€ê¾¸ê¸°"
    ]},
    { id:"ì •ë³´ì²˜ë¦¬", emoji:"ğŸ’»", colorFrom:"#a5f3fc", colorTo:"#c7d2fe", activities:[
      "íƒ€ìÂ·ë¬¸ì„œÂ·í”„ë ˆì  í…Œì´ì…˜","ê·¸ë¦¼Â·ë™ì˜ìƒ ë§Œë“¤ê¸°","ì¸í„°ë„· êµ¬ë§¤Â·ê²€ìƒ‰Â·í˜‘ì—…","AIÂ·ë¬´ì¸ë‹¨ë§Â·ë””ì§€í„¸ê¸ˆìœµ","ë“œë¡ Â·ì½”ë”©ë¡œë´‡ ì²´í—˜"
    ]},
    { id:"ì‚¬ë¬´ì§€ì›", emoji:"ğŸ—‚ï¸", colorFrom:"#e5e7eb", colorTo:"#e7e5e4", activities:[
      "ë³µí•©ê¸° ì‚¬ìš©Â·ë¬¸ì„œ ê´€ë¦¬","ì±…ìƒÂ·íƒ•ë¹„ì‹¤ ì •ëˆ","ìš°í¸ë¬¼ í¬ì¥Â·ì „ë‹¬","ë„ì„œ ë¶„ë¥˜Â·ì •ë¦¬","ë¯¼ì› ì‘ëŒ€ ë³´ì¡°"
    ]},
  ];

  // ===== ì„¤ì • =====
  const TOTAL_ROUNDS = 30;

  // ===== ìƒíƒœ =====
  let rounds = [];
  let step = 0;
  let scores = Object.fromEntries(SUBJECTS.map(s => [s.id, 0]));
  let student = { school:"", grade:"", name:"" };

  // ===== ìœ í‹¸ =====
  const $ = (s) => document.querySelector(s);
  function randPick(arr) { return arr[Math.floor(Math.random()*arr.length)]; }
  function makeGradient(from, to) { return `linear-gradient(135deg, ${from}, ${to})`; }
  function showPage(id) {
    ["page-start","page-info","page-game","page-result"].forEach(x => document.getElementById(x).classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");
  }
  function saveStudentFromForm() {
    student.school = $('#school').value.trim();
    student.grade  = $('#grade').value.trim();
    student.name   = $('#name').value.trim();
    localStorage.setItem("worldcup_student", JSON.stringify(student));
  }
  function loadStudent() {
    try {
      const s = JSON.parse(localStorage.getItem("worldcup_student") || "{}");
      student = Object.assign({ school:"", grade:"", name:"" }, s);
      $('#school').value = student.school;
      $('#grade').value  = student.grade;
      $('#name').value   = student.name;
    } catch(e) {}
  }
  function updateStudentMeta() {
    const text = [student.school, student.grade, student.name].filter(Boolean).join(" Â· ");
    $('#studentMeta').textContent = text ? `í•™ìƒì •ë³´: ${text}` : "í•™ìƒì •ë³´: (ë¯¸ì…ë ¥)";
  }

  // ë‘ êµê³¼ë¥¼ ë¬´ì‘ìœ„ë¡œ ë½‘ê³ , ê° êµê³¼ ë‚´ í™œë™ 1ê°œë§Œ ì„ íƒ
  function makeRounds(total = TOTAL_ROUNDS) {
    const rs = [];
    for (let i=0;i<total;i++) {
      let a = randPick(SUBJECTS);
      let b = randPick(SUBJECTS);
      while (b.id === a.id) b = randPick(SUBJECTS);
      const aAct = randPick(a.activities);
      const bAct = randPick(b.activities);
      rs.push({ a:{...a, highlight: aAct}, b:{...b, highlight: bAct} });
    }
    return rs;
  }

  function renderChoiceCard(data) {
    const wrap = document.createElement('div');
    wrap.className = 'card';
    wrap.innerHTML = `
      <div class="card-body">
        <div class="illus" style="background:${makeGradient(data.colorFrom, data.colorTo)}">
          <span aria-hidden="true">${data.emoji}</span>
        </div>
        <div class="title">${data.highlight}</div>
        <button class="btn">ì´ìª½ì´ ë” ëŒë ¤ìš”</button>
      </div>
    `;
    // ë²„íŠ¼ê³¼ ê·¸ë¦¼ ëª¨ë‘ í´ë¦­ ì‹œ ì„ íƒ
    wrap.querySelector('.btn').addEventListener('click', () => choose(data.id));
    wrap.querySelector('.illus').addEventListener('click', () => choose(data.id));
    return wrap;
  }

  function renderStep() {
    $('#stepNow').textContent = step;
    $('#progress').value = step;
    const current = rounds[step];
    const choices = $('#choices');
    choices.innerHTML = '';
    if (current) {
      choices.appendChild(renderChoiceCard(current.a));
      choices.appendChild(renderChoiceCard(current.b));
    }
  }

  function choose(subjectId) {
    scores[subjectId] = (scores[subjectId] || 0) + 1;
    if (step + 1 >= TOTAL_ROUNDS) {
      finish();
    } else {
      step += 1;
      renderStep();
    }
  }

  function finish() {
    showPage('page-result');
    updateStudentMeta();

    const ranking = SUBJECTS.map(s => ({ subject:s, score: scores[s.id] }))
      .sort((a,b) => b.score - a.score);

    const grid = $('#rankGrid');
    grid.innerHTML = '';
    ranking.forEach((r, idx) => {
      const item = document.createElement('div');
      const medal = idx===0 ? "ğŸ¥‡" : idx===1 ? "ğŸ¥ˆ" : idx===2 ? "ğŸ¥‰" : "";
      item.className = 'badge';
      item.innerHTML = `
        <h4><span class="rank">${idx+1}ìœ„</span> ${medal} ${r.subject.id} <span class="muted">(${r.score}ì )</span></h4>
        <ul style="margin:0; padding-left:18px; font-size: 13px;">
          ${r.subject.activities.slice(0,4).map(a=>`<li>${a}</li>`).join('')}
        </ul>
      `;
      grid.appendChild(item);
    });
    window.scrollTo(0,0);
  }

  function restart(shuffle=false) {
    scores = Object.fromEntries(SUBJECTS.map(s => [s.id, 0]));
    step = 0;
    if (shuffle) rounds = makeRounds();
    showPage('page-game');
    renderStep();
  }

  function downloadJSON() {
    const ranking = SUBJECTS.map(s => ({ subject:s.id, score: scores[s.id] }))
      .sort((a,b)=>b.score-a.score);
    const payload = {
      total: TOTAL_ROUNDS,
      scores,
      ranking,
      student,
      timestamp: new Date().toISOString()
    };
    const blob = new Blob([JSON.stringify(payload, null, 2)], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `í¥ë¯¸ê²°ê³¼_${new Date().toISOString().slice(0,10)}.json`;
    a.click();
    URL.revokeObjectURL(url);
  }

  function printPDF() {
    // ì¸ì‡„ ì „ í•™ìƒ ì •ë³´ ì—…ë°ì´íŠ¸
    updateStudentMeta();
    // ì¸ì‡„ ë‹¤ì´ì–¼ë¡œê·¸ (ì‚¬ìš©ì ì¸¡ì—ì„œ 'PDFë¡œ ì €ì¥' ì„ íƒ ê°€ëŠ¥)
    window.print();
  }

  // ===== ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ =====
  $('#navStart').addEventListener('click', () => showPage('page-start'));
  $('#navInfo').addEventListener('click', () => showPage('page-info'));
  $('#navGame').addEventListener('click', () => showPage('page-game'));
  $('#printBtn').addEventListener('click', printPDF);

  // ì‹œì‘ í˜ì´ì§€ CTA
  $('#startToInfo').addEventListener('click', () => showPage('page-info'));
  $('#startToGame').addEventListener('click', () => { showPage('page-game'); });

  // ì •ë³´ ì…ë ¥ í˜ì´ì§€
  $('#infoToGame').addEventListener('click', () => { saveStudentFromForm(); showPage('page-game'); });
  $('#infoClear').addEventListener('click', () => { $('#school').value=''; $('#grade').value=''; $('#name').value=''; saveStudentFromForm(); });

  // ê²°ê³¼ ë²„íŠ¼
  $('#againBtn').addEventListener('click', () => restart(false));
  $('#reshuffleBtn').addEventListener('click', () => { rounds = makeRounds(); restart(false); });
  $('#downloadBtn').addEventListener('click', downloadJSON);
  $('#printBtn2').addEventListener('click', printPDF);

  // ì´ˆê¸° ì„¤ì •
  document.getElementById('year').textContent = new Date().getFullYear();
  document.getElementById('stepMax').textContent = TOTAL_ROUNDS;
  document.getElementById('roundTotal').textContent = TOTAL_ROUNDS;
  loadStudent();
  rounds = makeRounds();
  showPage('page-start'); // ì‹œì‘ì€ ëœë”©
</script>
</body>
</html>
